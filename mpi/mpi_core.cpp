#include "mpi_core.hpp"
#include "error.hpp"

namespace Mpi
{
//####################################################################################################################
	Context::Context(int root)
		: root_{root}
	{
		int res = MPI_Init(nullptr, nullptr);
		print_error(res);
	}
//--------------------------------------------------------------------------------------------------------------------
	Context::~Context()
	{
		int res = MPI_Finalize();
		print_error(res);
	}
//--------------------------------------------------------------------------------------------------------------------
	int Context::id() const
	{
		int id;
		int res = MPI_Comm_rank(MPI_COMM_WORLD, &id);
		print_error(res);
		return id;
	}
//--------------------------------------------------------------------------------------------------------------------
	int Context::size() const
	{
		int size;
		int res = MPI_Comm_size(MPI_COMM_WORLD, &size);
		print_error(res);
		return size;
	}
//--------------------------------------------------------------------------------------------------------------------
	int Context::root() const
	{
		return root_;
	}
//--------------------------------------------------------------------------------------------------------------------
	bool Context::is_root() const
	{
		return id() == root_;
	}
//#####################################################################################################################
}
